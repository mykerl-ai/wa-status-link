<!DOCTYPE html>
<html>
<head>
    <title>Vendor Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f7f6; max-width: 600px; margin: auto; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        input, select, button { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #ddd; box-sizing: border-box; }
        button { background: #007bff; color: white; border: none; font-weight: bold; cursor: pointer; }
        .gallery { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .item-card { background: #fff; border: 1px solid #eee; padding: 10px; border-radius: 10px; text-align: center; }
        .item-card img { width: 100%; border-radius: 5px; }
        .wa-btn { background: #25D366; }
        #loading { display: none; color: #007bff; font-weight: bold; text-align: center; }
    </style>
</head>
<body>

<div class="card">
    <h2>ðŸš€ Bulk AI Studio</h2>
    <form id="bulkForm">
        <label>1. Pick Background Theme:</label>
        <select name="bgColor">
            <option value="white">Pristine White</option>
            <option value="black">Premium Black</option>
            <option value="#f8bbd0">Soft Pink</option>
            <option value="#e0e0e0">Light Grey</option>
            <option value="#fff9c4">Warm Cream</option>
        </select>

        <label>2. Select Photos/Videos:</label>
        <input type="file" id="fileInput" name="files" multiple required>
        
        <div id="priceInputs"></div>
        <button type="submit" id="uploadBtn">Upload & Enhance</button>
    </form>
    <div id="loading">âœ¨ AI is stripping backgrounds and generating studio lighting...</div>
</div>

<div id="resultArea" style="display:none;">
    <div class="gallery" id="bulkGallery"></div>
</div>

<script>
    const fileInput = document.getElementById('fileInput');
    const priceInputs = document.getElementById('priceInputs');

    fileInput.onchange = () => {
        priceInputs.innerHTML = '<h4>Enter Prices:</h4>';
        Array.from(fileInput.files).forEach((file, i) => {
            priceInputs.innerHTML += `<input type="text" name="prices" placeholder="Price for ${file.name}" required>`;
        });
    };

    document.getElementById('bulkForm').onsubmit = async (e) => {
        e.preventDefault();
        document.getElementById('loading').style.display = 'block';
        document.getElementById('uploadBtn').disabled = true;

        const formData = new FormData(e.target);
        const res = await fetch('/upload-bulk', { method: 'POST', body: formData });
        const data = await res.json();

        document.getElementById('loading').style.display = 'none';
        if(data.success) {
            const gallery = document.getElementById('bulkGallery');
            gallery.innerHTML = '';
            data.items.forEach(item => {
                gallery.innerHTML += `
                    <div class="item-card">
                        <img src="${item.previewUrl}">
                        <p>Price: ${item.price}</p>
                        <button class="wa-btn" onclick="shareSingle('${item.link}', '${item.price}')">Share to Status</button>
                    </div>`;
            });
            document.getElementById('resultArea').style.display = 'block';
        }
    };

    function shareSingle(link, price) {
        const text = encodeURIComponent(`Price: ${price}\n\nTap to view details: ${link}`);
        window.open(`https://wa.me/?text=${text}`);
    }
</script>
</body>
</html>
